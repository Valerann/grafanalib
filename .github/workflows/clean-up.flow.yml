# Generated by Flow - do not edit the file
name: clean-up
on:
  schedule:
    # every day at midnight
    - cron: "0 0 * * *"
jobs:
  clean-up:
    env:
      GH_TOKEN: ${{ secrets.VLN_GH_TOKEN }}
      SLACK_TOKEN: ${{ secrets.VLN_SLACK_TOKEN }}
      JIRA_API_TOKEN: ${{ secrets.VLN_JIRA_API_TOKEN }}
    runs-on: [self-hosted, linux, X64, dev, vm]
    steps:
      - uses: actions/checkout@master
        with:
          ssh-key: ${{ secrets.VLN_SSH_KEY }}
          fetch-depth: 0
      - name: clean-up
        run: |
          echo "-- Runner: $GITHUB_RUNNER_NAME --"
          vln docker rm --non-versioned --aws-profile dev--ecr --skip dataui
  collect-metrics:
    if: ${{ always() }}
    env:
      GH_TOKEN: ${{ secrets.VLN_GH_TOKEN }}
    needs: [clean-up]
    runs-on: [self-hosted, linux, X64, dev, vm]
    steps:
      - name: collect-metrics
        run: |
          tim collect-metrics github-workflow