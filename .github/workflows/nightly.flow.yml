# Generated by Flow - do not edit the file
name: nightly
on:
  schedule:
    # every day at 1 am
    - cron: "0 1 * * *"
jobs:
  nightly:
    env:
      GH_TOKEN: ${{ secrets.VLN_GH_TOKEN }}
      SLACK_TOKEN: ${{ secrets.VLN_SLACK_TOKEN }}
      JIRA_API_TOKEN: ${{ secrets.VLN_JIRA_API_TOKEN }}
    runs-on: [self-hosted, linux, X64, dev, vm]
    steps:
      - uses: actions/checkout@master
        with:
          ssh-key: ${{ secrets.VLN_SSH_KEY }}
          fetch-depth: 0
      - name: nightly
        run: |
          flow test --slack
  collect-metrics:
    if: ${{ always() }}
    env:
      GH_TOKEN: ${{ secrets.VLN_GH_TOKEN }}
    needs: [nightly]
    runs-on: [self-hosted, linux, X64, dev, vm]
    steps:
      - name: collect-metrics
        run: |
          tim collect-metrics github-workflow